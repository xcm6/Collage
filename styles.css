/* Base */
:root { --bg: #0e0f12; }
* { box-sizing: border-box; }
html, body { height: 100%; }
body { margin: 0; background: var(--bg); }

/* Canvas */
.canvas {
  position: relative;
  min-height: 100svh;
  overflow: hidden;
  background:
    radial-gradient(600px 400px at 20% 10%, #151821 0%, rgba(14,15,18,0) 60%),
    radial-gradient(800px 600px at 80% 20%, #0f131b 0%, rgba(14,15,18,0) 70%),
    #0e0f12;
}
.nav-fracture {
  position: fixed;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 999;
  display: flex;
  gap: 16px;
  pointer-events: none; /* 容器不接收事件，子元素接收 */
}
.nav-fracture a {
  pointer-events: auto;
  position: relative;
  display: inline-block;
  text-decoration: none;
  color: #fff;
  font: 800 clamp(18px, 4vw, 48px)/1.1 ui-serif, Georgia, "Times New Roman", serif;
  letter-spacing: 0.08em;
  isolation: isolate;
  text-shadow:
    1px 0 0 rgba(255,0,0,.55),
    -1px 0 0 rgba(0,180,255,.55),
    0 1px 18px rgba(0,0,0,.45);
}
.nav-fracture a .layer {
  position: absolute;
  inset: 0;
  content: "";
  will-change: transform, opacity;
}
.nav-fracture a span.label { position: relative; display: inline-block; opacity: .92; mix-blend-mode: screen; }
/* 裂变层 + RGB 叠加：将裂变层绑定到 label 上，避免影响点击区域 */
.nav-fracture a .label::before,
.nav-fracture a .label::after {
  content: attr(data-label);
  position: absolute;
  inset: 0;
  color: #ffffff;
  filter: blur(.2px);
}
/* 红/蓝通道偏移（色散） */
.nav-fracture a .label::before { transform: translate(-1.2px, -0.4px) rotate(-2deg); color: rgba(255,0,0,.75); mix-blend-mode: screen; opacity: .9; }
.nav-fracture a .label::after  { transform: translate(1.2px, 0.4px) rotate(2deg);  color: rgba(0,180,255,.75); mix-blend-mode: screen; opacity: .85; }
/* 再叠两层上下错位，营造撕裂（用额外阴影模拟纸边）*/
.nav-fracture a .label::before { text-shadow: 0 10px 18px rgba(0,0,0,.45); }
.nav-fracture a .label::after  { text-shadow: 0 10px 18px rgba(0,0,0,.45); }
.nav-fracture a:hover .label::before { transform: translate(-2px, -0.8px) rotate(-4deg); opacity: 1; }
.nav-fracture a:hover .label::after  { transform: translate(2px, 0.8px) rotate(4deg);  opacity: 1; }
.nav-fracture a.is-active span.label { text-decoration: underline; text-decoration-thickness: .12em; text-underline-offset: .12em; }

/* 每页风格微调入口（可按需覆盖） */
.theme-paper .nav-fracture a { color: #f2efe6; }
.theme-paper .nav-fracture a::before { color: #ffffff; }
.theme-paper .nav-fracture a::after { color: #d8d1c1; }
.canvas::before {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 0;
  background:
    radial-gradient(1200px 800px at 70% 20%, rgba(0,0,0,0.45), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.25)),
    var(--bg-image, none);
  background-size: cover;
  background-position: center;
  background-blend-mode: multiply, multiply, normal;
  filter: saturate(.9) contrast(.95);
}

/* 右上角编号 */
.corner-id {
  position: fixed;
  top: 10px;
  right: 12px;
  z-index: 1000;
  color: rgba(255,255,255,.9);
  font: 700 clamp(10px, 1.6vw, 14px)/1.2 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  letter-spacing: 0.06em;
  text-shadow: 0 10px 18px rgba(0,0,0,.45), 1px 0 0 rgba(255,0,0,.4), -1px 0 0 rgba(0,180,255,.4);
  pointer-events: none;
}

/* Page2 大标题（类似 page1 风格） */
.p2-title {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 800;
  font: 900 clamp(28px, 8vw, 120px)/0.9 ui-serif, Georgia, "Times New Roman", serif;
  letter-spacing: 0.06em;
  color: #f7f7f7;
  text-align: center;
  mix-blend-mode: difference;
}
.p2-title::before,
.p2-title::after {
  content: attr(data-text);
  position: absolute;
  inset: 0;
}
.p2-title { text-shadow: 0 0 24px rgba(255,255,255,.25); }
.p2-title::before { color: rgba(255,0,120,.8); transform: translate(-2px, -1px); filter: blur(.3px); mix-blend-mode: screen; }
.p2-title::after  { color: rgba(0,200,255,.75); transform: translate(2px, 1px);  filter: blur(.3px); mix-blend-mode: screen; }

/* Page2 Daily 小字体 - 纯色 */
.p2-subtitle {
  position: fixed;
  left: 50%;
  bottom: 2vh;
  transform: translateX(-50%);
  z-index: 800;
  font-family: 'Helvetica Neue', Arial, sans-serif;
  font-size: clamp(12px, 2vw, 24px);
  font-weight: 300;
  letter-spacing: 0.2em;
  color: #fff;
  text-transform: uppercase;
  text-align: center;
  opacity: 1;
  text-shadow: 
    2px 2px 4px rgba(0,0,0,0.8),
    0 0 8px rgba(0,0,0,0.6);
}

/* Page1 视觉标题：“疯狂磕药”风格（RGB分离 + 波形扭曲） */
.p1-title {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 800;
  font: 900 clamp(28px, 8vw, 120px)/0.9 ui-serif, Georgia, "Times New Roman", serif;
  letter-spacing: 0.06em;
  color: #f7f7f7;
  text-align: center;
  mix-blend-mode: difference;
}
.p1-title::before,
.p1-title::after {
  content: attr(data-text);
  position: absolute;
  inset: 0;
}
.p1-title { text-shadow: 0 0 24px rgba(255,255,255,.25); }
.p1-title::before { color: rgba(255,0,120,.8); transform: translate(-2px, -1px); filter: blur(.3px); mix-blend-mode: screen; }
.p1-title::after  { color: rgba(0,200,255,.75); transform: translate(2px, 1px);  filter: blur(.3px); mix-blend-mode: screen; }


@keyframes chroma-warp {
  0%   { transform: translate(-50%, -50%) skewX(0deg) skewY(0deg); }
  33%  { transform: translate(calc(-50% + .6vw), calc(-50% + .3vh)) skewX(2deg) skewY(-1deg); }
  66%  { transform: translate(calc(-50% - .6vw), calc(-50% - .4vh)) skewX(-2deg) skewY(1deg); }
  100% { transform: translate(-50%, -50%) skewX(0deg) skewY(0deg); }
}
.p1-title { animation: none; }

.piece {
  position: absolute;
  transform-origin: center;
  filter: drop-shadow(0 10px 18px rgba(0,0,0,0.45));
  mix-blend-mode: screen; /* 让浅色小票彼此叠加产生发光感 */
  backface-visibility: hidden;
  -webkit-font-smoothing: antialiased;
  will-change: transform, left, top;
  contain: paint;
}
.piece img { display: block; width: 100%; height: auto; transform: translateZ(0); }

/* 手感：轻微入场与悬停挪移 */
.piece { transition: transform .35s ease, filter .35s ease, opacity .35s ease; }
.piece:hover { transform: translateY(-4px) rotate(var(--rot, 0deg)) scale(1.02); filter: drop-shadow(0 16px 30px rgba(0,0,0,0.55)); }

/* 排布：使用 CSS 变量控制旋转与尺寸（更易微调） */
.i1  { --rot: -6deg; left: 8vw;  top: 8vh;  width: 26vw; transform: rotate(var(--rot)); }
.i2  { --rot: 8deg;  left: 20vw; top: 18vh; width: 22vw; transform: rotate(var(--rot)); }
.i3  { --rot: -2deg; left: 36vw; top: 10vh; width: 24vw; transform: rotate(var(--rot)); }
.i4  { --rot: 14deg; left: 54vw; top: 6vh;  width: 20vw; transform: rotate(var(--rot)); }
.i5  { --rot: -10deg;left: 66vw; top: 20vh; width: 24vw; transform: rotate(var(--rot)); }
.i6  { --rot: 5deg;  left: 10vw; top: 40vh; width: 28vw; transform: rotate(var(--rot)); }
.i7  { --rot: -12deg;left: 32vw; top: 34vh; width: 20vw; transform: rotate(var(--rot)); }
.i8  { --rot: 4deg;  left: 46vw; top: 42vh; width: 26vw; transform: rotate(var(--rot)); }
.i9  { --rot: -4deg; left: 64vw; top: 40vh; width: 22vw; transform: rotate(var(--rot)); }
.i10 { --rot: 2deg;  left: 24vw; top: 60vh; width: 24vw; transform: rotate(var(--rot)); }
.i11 { --rot: -8deg; left: 48vw; top: 64vh; width: 28vw; transform: rotate(var(--rot)); }

/* 小屏优化：缩放并收拢分布 */
@media (max-width: 680px) {
  .i1  { left: 6vw;  top: 6vh;  width: 60vw; }
  .i2  { left: 28vw; top: 12vh; width: 56vw; }
  .i3  { left: 10vw; top: 24vh; width: 58vw; }
  .i4  { left: 30vw; top: 30vh; width: 52vw; }
  .i5  { left: 40vw; top: 44vh; width: 58vw; }
  .i6  { left: 4vw;  top: 48vh; width: 64vw; }
  .i7  { left: 22vw; top: 56vh; width: 50vw; }
  .i8  { left: 8vw;  top: 66vh; width: 60vw; }
  .i9  { left: 34vw; top: 72vh; width: 50vw; }
  .i10 { left: 6vw;  top: 82vh; width: 58vw; }
  .i11 { left: 26vw; top: 90vh; width: 62vw; }
}

/* --- Page3 混沌复制层效果 --- */
.copy-layer {
  position: absolute;
  inset: 0;
  pointer-events: none;
}
.piece.copy {
  mix-blend-mode: difference;
  opacity: .85;
  animation: none; /* 取消抖动/闪烁 */
}
.piece.copy.alt { mix-blend-mode: exclusion; opacity: .7; animation: none; }
.piece.copy.rb  { filter: hue-rotate(12deg) saturate(1.2); animation: none; }

/* 拖拽时尽量减少重绘与混合开销 */
.dragging { transition: none !important; will-change: left, top; }
.drag-mode .piece.copy { mix-blend-mode: normal; opacity: .45; }

/* page3 稳定性优化：主层不参与混合，仅复制层参与，避免 hover 闪烁 */
.theme-chaos .piece { mix-blend-mode: normal; }

@keyframes jitter {
  0%   { transform: translate(-0.6px, 0.4px) rotate(var(--rot, 0deg)) scale(1.005); }
  50%  { transform: translate(0.8px, -0.6px) rotate(calc(var(--rot, 0deg) + .6deg)) scale(1.0); }
  100% { transform: translate(-0.6px, 0.4px) rotate(var(--rot, 0deg)) scale(1.005); }
}


/* --- Page3 包豪斯拼贴 Collage - CSS Grid --- */
.theme-bauhaus .canvas { 
    background: #f8f6f0 !important; 
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(3, 1fr);
    width: 100vw;
    height: 100vh;
    gap: 0;
    overflow: hidden;
}

.theme-bauhaus .bauhaus { 
    border: 2px solid #000;
    box-shadow: 4px 4px 0px rgba(0,0,0,0.3);
    transition: transform 0.2s ease;
    cursor: pointer;
    overflow: hidden;
}

.theme-bauhaus .bauhaus:hover { 
    transform: translate(-2px, -2px); 
    box-shadow: 6px 6px 0px rgba(0,0,0,0.4);
}

.theme-bauhaus .bauhaus img { 
    width: 100%; 
    height: 100%; 
    object-fit: cover; 
    display: block;
}

/* 几何形状样式 */
.bauhaus.circle { 
    border-radius: 50%; 
    border: none; 
}

.bauhaus.triangle { 
    width: 0; 
    height: 0; 
    border-left: 15vw solid transparent;
    border-right: 15vw solid transparent;
    border-bottom: 25vh solid currentColor;
    background: none !important;
    border: none;
}

.bauhaus.triangle img { 
    display: none; 
}

.bauhaus.diamond { 
    transform: rotate(45deg); 
    border-radius: 0;
}

.bauhaus.diamond img { 
    transform: rotate(-45deg); 
    border-radius: 0;
}

.bauhaus.hexagon { 
    width: 20vw; 
    height: 20vh; 
    background: currentColor;
    position: relative;
}

.bauhaus.hexagon:before,
.bauhaus.hexagon:after {
    content: "";
    position: absolute;
    width: 0;
    border-left: 10vw solid transparent;
    border-right: 10vw solid transparent;
}

.bauhaus.hexagon:before {
    bottom: 100%;
    border-bottom: 10vh solid currentColor;
}

.bauhaus.hexagon:after {
    top: 100%;
    border-top: 10vh solid currentColor;
}

.bauhaus.pentagon { 
    width: 18vw; 
    height: 18vh; 
    background: currentColor;
    position: relative;
    clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);
}

.bauhaus.octagon { 
    width: 16vw; 
    height: 16vh; 
    background: currentColor;
    position: relative;
    clip-path: polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%);
}

/* Page3 标题：与 page1/page2 相同的 RGB 分离效果 */
.p3-title {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 800;
  font: 900 clamp(28px, 8vw, 120px)/0.9 ui-serif, Georgia, "Times New Roman", serif;
  letter-spacing: 0.06em;
  color: #f7f7f7;
  text-align: center;
  mix-blend-mode: difference;
}

.p3-title::before,
.p3-title::after {
  content: attr(data-text);
  position: absolute;
  inset: 0;
}
.p3-title { text-shadow: 0 0 24px rgba(255,255,255,.25); }
.p3-title::before { color: rgba(255,0,120,.8); transform: translate(-2px, -1px); filter: blur(.3px); mix-blend-mode: screen; }
.p3-title::after  { color: rgba(0,200,255,.75); transform: translate(2px, 1px);  filter: blur(.3px); mix-blend-mode: screen; }

/* Page3 Ultra-Minimal 小字体 - RGB 分离效果 */
.p3-subtitle {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, calc(-50% + 8vh));
  z-index: 800;
  font-family: 'Helvetica Neue', Arial, sans-serif;
  font-size: clamp(12px, 2vw, 24px);
  font-weight: 300;
  letter-spacing: 0.2em;
  color: #f7f7f7;
  text-transform: uppercase;
  text-align: center;
  mix-blend-mode: difference;
}

.p3-subtitle::before,
.p3-subtitle::after {
  content: attr(data-text);
  position: absolute;
  inset: 0;
}
.p3-subtitle { text-shadow: 0 0 12px rgba(255,255,255,.15); }
.p3-subtitle::before { color: rgba(255,0,120,.6); transform: translate(-1px, -0.5px); filter: blur(.2px); mix-blend-mode: screen; }
.p3-subtitle::after  { color: rgba(0,200,255,.5); transform: translate(1px, 0.5px);  filter: blur(.2px); mix-blend-mode: screen; }

/* CSS Grid 拼贴布局 */
.bauhaus.red { grid-column: 1 / 3; grid-row: 1 / 2; transform: rotate(-3deg); }
.bauhaus.blue { grid-column: 3 / 5; grid-row: 1 / 2; transform: rotate(5deg); }
.bauhaus.yellow { grid-column: 1 / 2; grid-row: 2 / 4; transform: rotate(-8deg); }
.bauhaus.black { grid-column: 2 / 3; grid-row: 2 / 3; transform: rotate(4deg); }
.bauhaus.white { grid-column: 3 / 4; grid-row: 2 / 4; transform: rotate(-6deg); }
.bauhaus.green { grid-column: 2 / 4; grid-row: 3 / 4; transform: rotate(7deg); }
.bauhaus.orange { grid-column: 4 / 5; grid-row: 2 / 3; transform: rotate(-5deg); }
.bauhaus.grey { grid-column: 4 / 5; grid-row: 3 / 4; transform: rotate(6deg); }
.bauhaus.deep-blue { grid-column: 1 / 2; grid-row: 1 / 2; transform: rotate(-4deg); }
.bauhaus.deep-green { grid-column: 2 / 3; grid-row: 1 / 2; transform: rotate(8deg); }

